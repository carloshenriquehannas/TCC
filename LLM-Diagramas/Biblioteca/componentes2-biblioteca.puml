@startuml componentes2-biblioteca
title Sistema Biblioteca — Diagrama de Componentes
left to right direction
'skinparam componentStyle rectangle
'skinparam linetype ortho

component "Identidade & Acesso (IAM/RBAC)" as IAM
component "Gestão de Perfis" as Perfis
component "Gestão de Salas" as Salas
component "Gestão de Equipamentos" as Equip
component "Motor de Agendamento & Disponibilidade" as Agendamento
component "Reservas" as Reservas
component "Notificações" as Notificacoes
component "Observabilidade\n(Logs & Monitoramento)" as Observabilidade
component "Backup & Recuperação" as Backup

' --- Autorização/autenticação (cross-cutting) ---
Perfis --> IAM : <<autoriza>>
Salas --> IAM : <<autoriza>>
Equip --> IAM : <<autoriza>>
Reservas --> IAM : <<autoriza>>

' --- Disponibilidade usa dados de recursos ---
Agendamento --> Salas : <<consulta atributos/capacidade>>
Agendamento --> Equip : <<considera restrições>>

' --- Reservas verifica disponibilidade e referencia recursos ---
Reservas --> Agendamento : <<verifica disponibilidade>>
Reservas ..> Salas : <<ouve eventos de bloqueio/alteração>>
Reservas ..> Equip : <<ouve eventos de bloqueio/alteração>>

' --- Notificações de reserva ---
Reservas --> Notificacoes : <<dispara e-mails>>

' --- Observabilidade (logs/monitoramento) ---
IAM --> Observabilidade : <<emite logs>>
Perfis --> Observabilidade : <<emite logs>>
Salas --> Observabilidade : <<emite logs>>
Equip --> Observabilidade : <<emite logs>>
Agendamento --> Observabilidade : <<emite logs>>
Reservas --> Observabilidade : <<emite logs>>
Notificacoes --> Observabilidade : <<emite logs>>
Backup --> Observabilidade : <<emite logs>>

' --- Backups periódicos de dados ---
Backup ..> Perfis : <<backup de dados>>
Backup ..> Salas : <<backup de dados>>
Backup ..> Equip : <<backup de dados>>
Backup ..> Reservas : <<backup de dados>>

@enduml
